<div class="recovery-container">
  <div class="recovery-card">
    <div class="recovery-header">
      <h1>ğŸ” Recuperar ContraseÃ±a</h1>
      <p>{{ step === 'email' ? 'Ingresa tu email para recibir un cÃ³digo' : 
           step === 'code' ? 'Verifica el cÃ³digo enviado a tu email' : 
           'Establece tu nueva contraseÃ±a' }}</p>
    </div>
    
    <!-- Paso 1: Solicitar cÃ³digo por email -->
    <form *ngIf="step === 'email'" (ngSubmit)="sendRecoveryCode()" class="recovery-form">
      <div class="form-group">
        <label for="email">Email:</label>
        <input 
          type="email" 
          id="email" 
          [(ngModel)]="email" 
          name="email"
          placeholder="tu@email.com"
          required>
      </div>
      
      <div *ngIf="error" class="error-message">
        {{ error }}
      </div>
      
      <button type="submit" [disabled]="loading" class="recovery-btn">
        {{ loading ? 'Enviando...' : 'Enviar CÃ³digo' }}
      </button>
    </form>

    <!-- Paso 2: Verificar cÃ³digo -->
    <form *ngIf="step === 'code'" (ngSubmit)="verifyCode()" class="recovery-form">
      <div class="success-message">
        âœ… CÃ³digo enviado a: {{ email }}
      </div>
      
      <div class="form-group">
        <label for="verificationCode">CÃ³digo de verificaciÃ³n:</label>
        <input 
          type="text" 
          id="verificationCode" 
          [(ngModel)]="verificationCode" 
          name="verificationCode"
          placeholder="Ingresa el cÃ³digo de 6 dÃ­gitos"
          required>
      </div>
      
      <div *ngIf="error" class="error-message">
        {{ error }}
      </div>
      
      <button type="submit" [disabled]="loading" class="recovery-btn">
        {{ loading ? 'Verificando...' : 'Verificar CÃ³digo' }}
      </button>

      <div class="resend-section">
        <button type="button" (click)="resendCode()" class="link-btn">
          Â¿No recibiste el cÃ³digo? Reenviar
        </button>
      </div>
    </form>

    <!-- Paso 3: Nueva contraseÃ±a -->
    <form *ngIf="step === 'newPassword'" (ngSubmit)="resetPassword()" class="recovery-form">
      <div class="form-group">
        <label for="newPassword">Nueva contraseÃ±a:</label>
        <div class="password-input-container">
          <input 
            [type]="showNewPassword ? 'text' : 'password'" 
            id="newPassword" 
            [(ngModel)]="newPassword" 
            name="newPassword"
            placeholder="MÃ­nimo 8 caracteres"
            required>
          <button 
            type="button" 
            class="password-toggle-btn"
            (click)="toggleNewPasswordVisibility()">
            {{ showNewPassword ? 'ğŸ™ˆ' : 'ğŸ‘ï¸' }}
          </button>
        </div>
      </div>

      <div class="form-group">
        <label for="confirmNewPassword">Confirmar nueva contraseÃ±a:</label>
        <div class="password-input-container">
          <input 
            [type]="showConfirmNewPassword ? 'text' : 'password'" 
            id="confirmNewPassword" 
            [(ngModel)]="confirmNewPassword" 
            name="confirmNewPassword"
            placeholder="Repite la nueva contraseÃ±a"
            required>
          <button 
            type="button" 
            class="password-toggle-btn"
            (click)="toggleConfirmNewPasswordVisibility()">
            {{ showConfirmNewPassword ? 'ğŸ™ˆ' : 'ğŸ‘ï¸' }}
          </button>
        </div>
      </div>
      
      <div *ngIf="error" class="error-message">
        {{ error }}
      </div>
      
      <button type="submit" [disabled]="loading" class="recovery-btn">
        {{ loading ? 'Actualizando...' : 'Restablecer ContraseÃ±a' }}
      </button>
    </form>
    
    <div class="recovery-footer">
      <button type="button" (click)="goToLogin()" class="link-btn">
        â† Volver al inicio de sesiÃ³n
      </button>
    </div>
  </div>
</div>
